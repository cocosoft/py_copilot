# æŠ€èƒ½å‘ç°æœºåˆ¶æ¶æ„è®¾è®¡

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®¾è®¡äº†Py Copiloté¡¹ç›®çš„æŠ€èƒ½å‘ç°æœºåˆ¶æ¶æ„ï¼ŒåŸºäºç°æœ‰æŠ€èƒ½ç®¡ç†ç³»ç»Ÿè¿›è¡Œæ‰©å±•å’Œä¼˜åŒ–ã€‚

## ğŸ” ç°æœ‰æœºåˆ¶åˆ†æ

### å½“å‰çŠ¶æ€
- **æŠ€èƒ½ç›®å½•ç»“æ„**ï¼š`app/skills/skills/`ä¸‹æŒ‰æŠ€èƒ½åç§°ç»„ç»‡
- **æŠ€èƒ½æ–‡ä»¶æ ¼å¼**ï¼šä½¿ç”¨`SKILL.md`æ–‡ä»¶ï¼ŒåŒ…å«YAML frontmatterå’Œå†…å®¹
- **å‘ç°æœºåˆ¶**ï¼šé€šè¿‡`SkillLoader`ç±»è§£ææŠ€èƒ½æ–‡ä»¶
- **æ³¨å†Œæœºåˆ¶**ï¼šé€šè¿‡`SkillService`ç®¡ç†æŠ€èƒ½æ³¨å†Œè¡¨

### ç°æœ‰ç»„ä»¶
1. **SkillLoader**ï¼šæŠ€èƒ½æ–‡ä»¶è§£æå™¨
2. **SkillService**ï¼šæŠ€èƒ½ç®¡ç†æœåŠ¡
3. **æŠ€èƒ½API**ï¼šæä¾›æŠ€èƒ½ç®¡ç†æ¥å£
4. **æŠ€èƒ½ç›®å½•**ï¼šæ ‡å‡†åŒ–çš„æŠ€èƒ½å­˜å‚¨ç»“æ„

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 1. æ•´ä½“æ¶æ„

```
æŠ€èƒ½å‘ç°æœºåˆ¶æ¶æ„
â”œâ”€â”€ æŠ€èƒ½ç›®å½•æ‰«æå™¨ (SkillDirectoryScanner)
â”œâ”€â”€ æŠ€èƒ½å…ƒæ•°æ®è§£æå™¨ (SkillMetadataParser)
â”œâ”€â”€ æŠ€èƒ½æ³¨å†Œå™¨ (SkillRegistry)
â”œâ”€â”€ æŠ€èƒ½ç´¢å¼•å™¨ (SkillIndexer)
â””â”€â”€ æŠ€èƒ½å‘ç°æœåŠ¡ (SkillDiscoveryService)
```

### 2. ç»„ä»¶èŒè´£

#### 2.1 æŠ€èƒ½ç›®å½•æ‰«æå™¨ (SkillDirectoryScanner)
**èŒè´£**ï¼šæ‰«ææŠ€èƒ½ç›®å½•ï¼Œå‘ç°æŠ€èƒ½æ–‡ä»¶
- æ”¯æŒå¤šç›®å½•æ‰«æ
- é€’å½’æ‰«æå­ç›®å½•
- è¿‡æ»¤æœ‰æ•ˆæŠ€èƒ½æ–‡ä»¶
- æ”¯æŒæ–‡ä»¶å˜æ›´ç›‘å¬

#### 2.2 æŠ€èƒ½å…ƒæ•°æ®è§£æå™¨ (SkillMetadataParser)
**èŒè´£**ï¼šè§£ææŠ€èƒ½å…ƒæ•°æ®ï¼ŒéªŒè¯å®Œæ•´æ€§
- è§£æYAML frontmatter
- éªŒè¯å¿…å¡«å­—æ®µ
- æå–å…ƒæ•°æ®ä¿¡æ¯
- ç”ŸæˆæŠ€èƒ½æ ‡è¯†ç¬¦

#### 2.3 æŠ€èƒ½æ³¨å†Œå™¨ (SkillRegistry)
**èŒè´£**ï¼šç®¡ç†æŠ€èƒ½æ³¨å†Œè¡¨ï¼Œæä¾›æŸ¥è¯¢æ¥å£
- ç»´æŠ¤æŠ€èƒ½æ³¨å†Œè¡¨
- å¤„ç†æŠ€èƒ½å†²çª
- æä¾›æŠ€èƒ½æŸ¥è¯¢API
- æ”¯æŒæŠ€èƒ½çŠ¶æ€ç®¡ç†

#### 2.4 æŠ€èƒ½ç´¢å¼•å™¨ (SkillIndexer)
**èŒè´£**ï¼šæ„å»ºæŠ€èƒ½ç´¢å¼•ï¼Œæ”¯æŒå¿«é€Ÿæœç´¢
- æ„å»ºæŠ€èƒ½å…¨æ–‡ç´¢å¼•
- æ”¯æŒå…³é”®è¯æœç´¢
- æä¾›ç›¸å…³æ€§æ’åº
- æ”¯æŒåˆ†ç±»è¿‡æ»¤

#### 2.5 æŠ€èƒ½å‘ç°æœåŠ¡ (SkillDiscoveryService)
**èŒè´£**ï¼šåè°ƒå‘ç°æµç¨‹ï¼Œæä¾›ç»Ÿä¸€æ¥å£
- åè°ƒå„ç»„ä»¶å·¥ä½œæµç¨‹
- æä¾›ç»Ÿä¸€å‘ç°æ¥å£
- å¤„ç†é”™è¯¯å’Œå¼‚å¸¸
- æä¾›ç›‘æ§å’Œæ—¥å¿—

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æŠ€èƒ½å‘ç°æµç¨‹

```python
def discover_skills():
    """æŠ€èƒ½å‘ç°ä¸»æµç¨‹"""
    # 1. æ‰«ææŠ€èƒ½ç›®å½•
    skill_files = scanner.scan_directories()
    
    # 2. è§£ææŠ€èƒ½å…ƒæ•°æ®
    skills_metadata = []
    for file_path in skill_files:
        metadata = parser.parse_skill_file(file_path)
        if metadata:
            skills_metadata.append(metadata)
    
    # 3. æ³¨å†ŒæŠ€èƒ½
    for metadata in skills_metadata:
        registry.register_skill(metadata)
    
    # 4. æ„å»ºç´¢å¼•
    indexer.build_index(skills_metadata)
    
    return skills_metadata
```

### 2. æ ¸å¿ƒæ¥å£è®¾è®¡

#### 2.1 æŠ€èƒ½æ‰«æå™¨æ¥å£
```python
class SkillScannerInterface:
    """æŠ€èƒ½æ‰«æå™¨æ¥å£"""
    
    def scan_directories(self, directories: List[str]) -> List[str]:
        """æ‰«ææŒ‡å®šç›®å½•ï¼Œè¿”å›æŠ€èƒ½æ–‡ä»¶è·¯å¾„åˆ—è¡¨"""
        pass
    
    def watch_directory(self, directory: str, callback: Callable) -> None:
        """ç›‘å¬ç›®å½•å˜åŒ–ï¼Œå®æ—¶å‘ç°æ–°æŠ€èƒ½"""
        pass
```

#### 2.2 æŠ€èƒ½è§£æå™¨æ¥å£
```python
class SkillParserInterface:
    """æŠ€èƒ½è§£æå™¨æ¥å£"""
    
    def parse_skill_file(self, file_path: str) -> Optional[SkillMetadata]:
        """è§£ææŠ€èƒ½æ–‡ä»¶ï¼Œè¿”å›æŠ€èƒ½å…ƒæ•°æ®"""
        pass
    
    def validate_metadata(self, metadata: SkillMetadata) -> bool:
        """éªŒè¯æŠ€èƒ½å…ƒæ•°æ®å®Œæ•´æ€§"""
        pass
```

#### 2.3 æŠ€èƒ½æ³¨å†Œå™¨æ¥å£
```python
class SkillRegistryInterface:
    """æŠ€èƒ½æ³¨å†Œå™¨æ¥å£"""
    
    def register_skill(self, metadata: SkillMetadata) -> bool:
        """æ³¨å†ŒæŠ€èƒ½åˆ°æ³¨å†Œè¡¨"""
        pass
    
    def unregister_skill(self, skill_id: str) -> bool:
        """ä»æ³¨å†Œè¡¨ç§»é™¤æŠ€èƒ½"""
        pass
    
    def get_skill(self, skill_id: str) -> Optional[SkillMetadata]:
        """æ ¹æ®IDè·å–æŠ€èƒ½"""
        pass
    
    def list_skills(self, filters: Dict = None) -> List[SkillMetadata]:
        """åˆ—å‡ºæ‰€æœ‰æŠ€èƒ½ï¼Œæ”¯æŒè¿‡æ»¤"""
        pass
```

### 3. æ•°æ®ç»“æ„è®¾è®¡

#### 3.1 æŠ€èƒ½å…ƒæ•°æ®æ¨¡å‹
```python
class SkillMetadata(BaseModel):
    """æŠ€èƒ½å…ƒæ•°æ®æ¨¡å‹"""
    skill_id: str
    name: str
    display_name: str
    description: str
    category: str
    version: str
    author: str
    tags: List[str] = []
    dependencies: List[str] = []
    enabled: bool = True
    file_path: str
    created_at: datetime
    updated_at: datetime
    config_schema: Optional[Dict] = None
```

#### 3.2 æŠ€èƒ½ç´¢å¼•æ¨¡å‹
```python
class SkillIndexEntry(BaseModel):
    """æŠ€èƒ½ç´¢å¼•æ¡ç›®"""
    skill_id: str
    name: str
    description: str
    category: str
    tags: List[str]
    search_terms: List[str]
    relevance_score: float = 0.0
```

## ğŸš€ å®ç°ç­–ç•¥

### 1. æ¸è¿›å¼æ”¹è¿›
- **é˜¶æ®µ1**ï¼šæ‰©å±•ç°æœ‰SkillLoaderï¼Œå¢å¼ºå…ƒæ•°æ®è§£æèƒ½åŠ›
- **é˜¶æ®µ2**ï¼šå®ç°ç›®å½•æ‰«æå™¨ï¼Œæ”¯æŒå¤šç›®å½•æ‰«æ
- **é˜¶æ®µ3**ï¼šæ„å»ºæŠ€èƒ½ç´¢å¼•å™¨ï¼Œæ”¯æŒå¿«é€Ÿæœç´¢
- **é˜¶æ®µ4**ï¼šå®ç°å®æ—¶å‘ç°æœºåˆ¶ï¼Œæ”¯æŒçƒ­åŠ è½½

### 2. å‘åå…¼å®¹æ€§
- ä¿æŒç°æœ‰`SKILL.md`æ–‡ä»¶æ ¼å¼å…¼å®¹
- æ”¯æŒç°æœ‰æŠ€èƒ½ç›®å½•ç»“æ„
- ä¿æŒç°æœ‰APIæ¥å£ä¸å˜
- é€æ­¥è¿ç§»åˆ°æ–°æ¶æ„

### 3. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ç¼“å­˜æœºåˆ¶å‡å°‘é‡å¤æ‰«æ
- å¢é‡ç´¢å¼•æ„å»ºï¼Œé¿å…å…¨é‡é‡å»º
- å¼‚æ­¥å¤„ç†å¤§ç›®å½•æ‰«æ
- æ”¯æŒåˆ†é¡µæŸ¥è¯¢ï¼Œé¿å…å†…å­˜æº¢å‡º

## ğŸ” å‘ç°æœºåˆ¶è¯¦ç»†è®¾è®¡

### 1. ç›®å½•æ‰«æç­–ç•¥

#### 1.1 æ‰«æèŒƒå›´
```python
DEFAULT_SCAN_DIRECTORIES = [
    "app/skills/skills",           # ä¸»æŠ€èƒ½ç›®å½•
    "app/skills/custom",          # è‡ªå®šä¹‰æŠ€èƒ½ç›®å½•
    "app/skills/third_party",     # ç¬¬ä¸‰æ–¹æŠ€èƒ½ç›®å½•
]
```

#### 1.2 æ–‡ä»¶è¿‡æ»¤è§„åˆ™
```python
VALID_SKILL_FILES = [
    "SKILL.md",                    # æ ‡å‡†æŠ€èƒ½æ–‡ä»¶
    "skill.yaml",                  # YAMLæ ¼å¼æŠ€èƒ½æ–‡ä»¶
    "skill.json",                  # JSONæ ¼å¼æŠ€èƒ½æ–‡ä»¶
]
```

#### 1.3 ç›®å½•æ’é™¤è§„åˆ™
```python
EXCLUDE_DIRECTORIES = [
    "__pycache__",
    ".git",
    "node_modules",
    "temp",
    "tmp",
]
```

### 2. å…ƒæ•°æ®è§£æç­–ç•¥

#### 2.1 å¿…å¡«å­—æ®µéªŒè¯
```python
REQUIRED_FIELDS = [
    "name",
    "description", 
    "version",
    "author",
]
```

#### 2.2 å­—æ®µç±»å‹éªŒè¯
```python
FIELD_VALIDATORS = {
    "name": lambda x: isinstance(x, str) and len(x) > 0,
    "version": lambda x: re.match(r'^\d+\.\d+\.\d+$', x),
    "tags": lambda x: isinstance(x, list) and all(isinstance(t, str) for t in x),
}
```

### 3. æ³¨å†Œè¡¨ç®¡ç†ç­–ç•¥

#### 3.1 å†²çªè§£å†³ç­–ç•¥
```python
class ConflictResolution:
    """å†²çªè§£å†³ç­–ç•¥"""
    
    SKIP = "skip"           # è·³è¿‡å†²çªæŠ€èƒ½
    OVERWRITE = "overwrite" # è¦†ç›–ç°æœ‰æŠ€èƒ½
    RENAME = "rename"       # é‡å‘½åæ–°æŠ€èƒ½
    MERGE = "merge"         # åˆå¹¶æŠ€èƒ½å…ƒæ•°æ®
```

#### 3.2 çŠ¶æ€ç®¡ç†
```python
class SkillStatus:
    """æŠ€èƒ½çŠ¶æ€"""
    
    ENABLED = "enabled"     # å·²å¯ç”¨
    DISABLED = "disabled"   # å·²ç¦ç”¨
    PENDING = "pending"     # å¾…å®¡æ ¸
    DEPRECATED = "deprecated" # å·²åºŸå¼ƒ
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### 1. å‘ç°æ€§èƒ½
- **æ‰«ææ—¶é—´**ï¼š1000ä¸ªæ–‡ä»¶åº”åœ¨5ç§’å†…å®Œæˆ
- **è§£æé€Ÿåº¦**ï¼šå•ä¸ªæ–‡ä»¶è§£ææ—¶é—´<100ms
- **å†…å­˜ä½¿ç”¨**ï¼šæ‰«æè¿‡ç¨‹ä¸­å†…å­˜å¢é•¿<100MB

### 2. æŸ¥è¯¢æ€§èƒ½
- **æœç´¢å“åº”**ï¼šå…³é”®è¯æœç´¢å“åº”æ—¶é—´<50ms
- **ç´¢å¼•æ„å»º**ï¼š1000ä¸ªæŠ€èƒ½çš„ç´¢å¼•æ„å»ºæ—¶é—´<10ç§’
- **å¹¶å‘æ”¯æŒ**ï¼šæ”¯æŒ100+å¹¶å‘æŸ¥è¯¢

## ğŸ”’ å®‰å…¨è€ƒè™‘

### 1. æ–‡ä»¶å®‰å…¨
- éªŒè¯æŠ€èƒ½æ–‡ä»¶æ¥æº
- æ£€æŸ¥æ–‡ä»¶æƒé™
- é˜²æ­¢è·¯å¾„éå†æ”»å‡»

### 2. å…ƒæ•°æ®å®‰å…¨
- éªŒè¯å…ƒæ•°æ®å®Œæ•´æ€§
- é˜²æ­¢æ³¨å…¥æ”»å‡»
- é™åˆ¶æ–‡ä»¶å¤§å°

### 3. è®¿é—®æ§åˆ¶
- æŠ€èƒ½è®¿é—®æƒé™æ§åˆ¶
- æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- å®¡è®¡æ—¥å¿—è®°å½•

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

### 1. ç›‘æ§æŒ‡æ ‡
- æŠ€èƒ½å‘ç°æ¬¡æ•°
- å‘ç°æˆåŠŸç‡
- å¹³å‡å‘ç°æ—¶é—´
- é”™è¯¯ç‡ç»Ÿè®¡

### 2. æ—¥å¿—è®°å½•
- è¯¦ç»†å‘ç°è¿‡ç¨‹æ—¥å¿—
- é”™è¯¯å’Œå¼‚å¸¸æ—¥å¿—
- æ€§èƒ½æŒ‡æ ‡æ—¥å¿—
- å®‰å…¨å®¡è®¡æ—¥å¿—

## ğŸ”„ æ‰©å±•æ€§è®¾è®¡

### 1. æ’ä»¶æ¶æ„
- æ”¯æŒè‡ªå®šä¹‰æ‰«æå™¨æ’ä»¶
- æ”¯æŒè‡ªå®šä¹‰è§£æå™¨æ’ä»¶
- æ”¯æŒè‡ªå®šä¹‰ç´¢å¼•å™¨æ’ä»¶

### 2. é…ç½®é©±åŠ¨
- æ”¯æŒé…ç½®æ–‡ä»¶å®šä¹‰æ‰«æè§„åˆ™
- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
- æ”¯æŒè¿è¡Œæ—¶é…ç½®æ›´æ–°

### 3. å›½é™…åŒ–æ”¯æŒ
- å¤šè¯­è¨€æŠ€èƒ½æè¿°æ”¯æŒ
- æœ¬åœ°åŒ–æœç´¢æ”¯æŒ
- å›½é™…åŒ–é”™è¯¯æ¶ˆæ¯

## ğŸ¯ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] èƒ½å¤Ÿæ‰«ææŒ‡å®šç›®å½•å‘ç°æŠ€èƒ½
- [ ] èƒ½å¤Ÿæ­£ç¡®è§£ææŠ€èƒ½å…ƒæ•°æ®
- [ ] èƒ½å¤Ÿå¤„ç†æŠ€èƒ½å†²çª
- [ ] èƒ½å¤Ÿæ„å»ºæŠ€èƒ½ç´¢å¼•
- [ ] æ”¯æŒæŠ€èƒ½æœç´¢å’Œè¿‡æ»¤

### æ€§èƒ½éªŒæ”¶
- [ ] æ‰«ææ€§èƒ½ç¬¦åˆè¦æ±‚
- [ ] æŸ¥è¯¢æ€§èƒ½ç¬¦åˆè¦æ±‚
- [ ] å†…å­˜ä½¿ç”¨ç¬¦åˆè¦æ±‚
- [ ] å¹¶å‘æ”¯æŒç¬¦åˆè¦æ±‚

### å®‰å…¨éªŒæ”¶
- [ ] æ–‡ä»¶å®‰å…¨éªŒè¯é€šè¿‡
- [ ] å…ƒæ•°æ®å®‰å…¨éªŒè¯é€šè¿‡
- [ ] è®¿é—®æ§åˆ¶éªŒè¯é€šè¿‡

## ğŸ“ æ€»ç»“

æœ¬æ¶æ„è®¾è®¡ä¸ºPy Copiloté¡¹ç›®æä¾›äº†å®Œæ•´çš„æŠ€èƒ½å‘ç°æœºåˆ¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### ä¼˜åŠ¿
- **å®Œæ•´æ€§**ï¼šè¦†ç›–æŠ€èƒ½å‘ç°å…¨æµç¨‹
- **æ‰©å±•æ€§**ï¼šæ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
- **æ€§èƒ½ä¼˜åŒ–**ï¼šè€ƒè™‘å¤§è§„æ¨¡æŠ€èƒ½ç®¡ç†
- **å®‰å…¨æ€§**ï¼šå…¨é¢çš„å®‰å…¨è€ƒè™‘

### å®æ–½ä»·å€¼
- **å¼€å‘æ•ˆç‡**ï¼šæä¾›æ ‡å‡†åŒ–çš„å‘ç°æœºåˆ¶
- **ç”¨æˆ·ä½“éªŒ**ï¼šæ”¯æŒå¿«é€ŸæŠ€èƒ½å‘ç°å’Œæœç´¢
- **ç”Ÿæ€å»ºè®¾**ï¼šä¸ºæŠ€èƒ½ç”Ÿæ€å‘å±•å¥ å®šåŸºç¡€

æ¶æ„è®¾è®¡å°†æŒ‡å¯¼åç»­çš„å…·ä½“å®ç°å·¥ä½œï¼Œç¡®ä¿æŠ€èƒ½å‘ç°æœºåˆ¶çš„é«˜æ•ˆã€å¯é å’Œå®‰å…¨ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2026-01-27  
**ç»´æŠ¤å›¢é˜Ÿ**ï¼šPy Copilotå¼€å‘å›¢é˜Ÿ